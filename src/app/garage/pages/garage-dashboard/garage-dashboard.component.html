<div class="grid grid-cols-12 grid-flow-row-dense gap-2">

  @if (authStore.isManager()) {
    <div class="border border-gary-200 rounded-lg col-span-4">
      <div class="h-24">LIENS RAPIDE</div>
    </div>

    <div class="border border-gary-200 rounded-lg col-span-12 p-4 grid gap-3">
      <h2 class="text-xl font-bold">Statistiques</h2>
      <div class="grid gap-y-10 px-7">
        <div>
          <h3 class="text-lg font-semibold">Prestations effectuées</h3>

          @if (isAttendanceChartBlank()) {
            <canvas baseChart class="w-full"
                    [type]="'line'"
                    [data]="lineChartData"
                    [options]="lineChartOptions"
                    [legend]="lineChartLegend"
            >
            </canvas>
          } @else {
            <div class=" inline-flex justify-center w-full"> Rien à afficher pour le moment ...</div>
          }
        </div>

        <div>
          <h3 class="text-lg font-semibold">Top services</h3>

          @if (isServicesChartBlank()) {
            <canvas baseChart class="w-1/2"
                    [type]="'pie'"
                    [data]="pieChartData"
                    [options]="pieChartOptions"
                    [legend]="pieChartLegend">
            </canvas>
          } @else {
            <div class=" inline-flex justify-center w-full"> Rien à afficher pour le moment ...</div>
          }

        </div>
      </div>
    </div>

    <div class="border border-gary-200 rounded-lg col-span-8 p-4 h-fit">
      <h2 class="text-xl font-bold">Informations générales</h2>
      <div class="flex items-center overflow-x-auto scroll-smooth max-w-full gap-3 py-3 custom-scrollbar ">
        @for (info of generalInfo; track $index) {
          <div class="bg-gray-100 rounded-lg p-3 shadow-sm">
            <p class="text-sm text-gray-700 mb-1">{{ info.title }}</p>
            <p class="text-xl font-bold">
              @if (info?.currency) {
                {{ info.value() | vola }}
              } @else {
                {{ info.value() }}
              }  </p>
          </div>
        }
      </div>
    </div>
  }

  @if (authStore.isMechanic()) {
    <div class="rounded-lg col-span-12">
      <div class="grid grid-cols-4 gap-x-3">
        <div class="grid grid-rows-[auto_1fr] border rounded-lg">
          <div class="flex p-2 items-center gap-x-3 rounded-t-lg bg-gray-100 border-b border-gray-200 h-14">
            <div class="rounded-full w-3 h-3 bg-orange-400"></div>
            <h2 class="text-lg font-semibold">En attente de confirmation</h2>
          </div>
          <div class="divide-y py-2 overflow-y-auto max-h-[calc(100vh-200px)]">
            @for (appointment of dashboardStore.mechanicsAppointments()?.pending; track appointment._id) {
              <div class="grid gap-y-2">
                <div class="px-3 pt-5 flex justify-between items-center border-b pb-1">
                  <span class="font-medium">{{ appointment.brandName }}</span>
                  <span
                    class="text-sm text-gray-600">{{ appointment.orderCreatedAt | luxonDate }}</span>
                </div>
                <div class="p-3">
                  <p>{{ appointment.vehicleDescription || 'Pas de description' }}</p>
                </div>
                <div class="p-3 bg-gray-50 flex justify-end gap-2">
                  <button
                    class="px-3 py-1 border border-black rounded-lg font-semibold flex items-center gap-1 hover:bg-red-600 hover:border-red-600 hover:text-white transition-colors"
                    (click)="setAppointmentDate(appointment._id)">
                    Fixer une date
                  </button>
                </div>
              </div>
            }
          </div>
        </div>

        <div class="grid grid-rows-[auto_1fr] border rounded-lg">
          <div class="flex p-2 items-center gap-x-3 rounded-t-lg bg-gray-100 border-b border-gray-200 h-14">
            <div class="rounded-full w-3 h-3 bg-purple-500"></div>
            <h2 class="text-lg font-semibold">Rendez-vous fixé</h2>
          </div>
          <div class="divide-y py-2 overflow-y-auto max-h-[calc(100vh-200px)]">

          </div>
        </div>

        <div class="grid grid-rows-[auto_1fr] border rounded-lg">
          <div class="flex p-2 items-center gap-x-3 rounded-t-lg bg-gray-100 border-b border-gray-200 h-14">
            <div class="rounded-full w-3 h-3 bg-blue-600"></div>
            <h2 class="text-lg font-semibold">En cours</h2>
          </div>
          <div class="divide-y py-2 overflow-y-auto max-h-[calc(100vh-200px)]">

          </div>
        </div>

        <div class="grid grid-rows-[auto_1fr] border rounded-lg">
          <div class="flex p-2 items-center gap-x-3 rounded-t-lg bg-gray-100 border-b border-gray-200 h-14">
            <div class="rounded-full w-3 h-3 bg-green-600"></div>
            <h2 class="text-lg font-semibold">Terminé</h2>
          </div>
          <div class="divide-y py-2 overflow-y-auto max-h-[calc(100vh-200px)]">

          </div>
        </div>
      </div>
    </div>
  }
</div>

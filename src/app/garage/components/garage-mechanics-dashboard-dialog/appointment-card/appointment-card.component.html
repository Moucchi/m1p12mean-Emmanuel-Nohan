<div class="grid rounded-lg">
  <div class="flex p-2 items-center gap-x-3 rounded-t-lg bg-gray-100">
    <div class="rounded-full w-3 h-3" [style.background-color]="color()"></div>
    <h2 class="text-lg font-semibold">{{ title() }}</h2>
  </div>

  @if (appointments()?.length ?? [].length > 0) {
    <div class="grid gap-y-2 py-2 overflow-y-auto max-h-[calc(100vh-200px)]">
      @for (appointment of appointments(); track appointment._id) {
        <div class="grid gap-y-2 border rounded-lg">
          <div class="flex items-center justify-between px-4 py-2">
            <img [ngSrc]="appointment.brandLogo" alt="vehicle_logo" width="82" height="82">
            <div>
              <p class="text-end">{{ appointment.brandName }}</p>
              @if (type() === 'pending') {
                <p class="text-end text-sm font-medium">{{ appointment.orderCreatedAt | luxonDate }}</p>
              }

              @if (type() !== 'pending') {
                <p class="text-end text-sm font-medium">Debut : {{ appointment.startedDate | luxonDate }}</p>
                <p class="text-end text-sm font-medium">Fin : {{ appointment.endingDate | luxonDate }}</p>
              }

            </div>
          </div>
          <div class="p-3">
            <p>{{ appointment.vehicleDescription || 'Pas de description' }}</p>
          </div>
          <div class="p-3 grid gap-2 items-center justify-end">
            @if (type() === 'pending') {
              <button
                class="px-3 py-1 border border-black rounded-lg font-semibold flex items-center gap-1 hover:bg-red-600 hover:border-red-600 hover:text-white transition-colors"
                (click)="onFixDate.emit(appointment._id)">
                Fixer une date
              </button>
            } @else if (type() === 'approved') {
              <button
                class="px-3 py-1 border border-black rounded-lg font-semibold flex items-center gap-1 hover:bg-red-600 hover:border-red-600 hover:text-white transition-colors"
                (click)="onFixDate.emit(appointment._id)">
                Commencer
              </button>
            } @else if (type() === 'in_progress') {
              <button
                class="px-3 py-1 border border-black rounded-lg font-semibold flex items-center gap-1 hover:bg-red-600 hover:border-red-600 hover:text-white transition-colors"
                (click)="onFixDate.emit(appointment._id)">
                Terminer
              </button>
            }

          </div>
        </div>
      }
    </div>
  } @else {
    <div class="p-5 text-center text-gray-500 italic flex items-center justify-center h-full border rounded-b-lg">
      {{ emptyMessage() }}
    </div>
  }
</div>
